(function(c,d){typeof exports=="object"&&typeof module<"u"?d(exports):typeof define=="function"&&define.amd?define(["exports"],d):(c=typeof globalThis<"u"?globalThis:c||self,d(c.CDWFW={}))})(this,(function(c){"use strict";const d=".cdw-accordion-item",l=".cdw-accordion-trigger",N=".cdw-accordion-panel",u=new WeakMap;let g=0;function b(e){return g+=1,`${e}-${g}`}function m(e,t){return e===null?t:e===""?!0:e==="true"}function H(e,t){return e==="multiple"?"multiple":t}function S(e,t){switch(e){case"plus":case"caret":case"arrow":case"dot":case"chevron":return e;default:return t}}function y(e){if(e==null)return[];if(Array.isArray(e))return e;if(typeof e=="number")return[e];if(typeof e=="string"){const t=e.trim();if(!t)return[];if(t.includes(","))return t.split(",").map(r=>r.trim()).filter(Boolean).map(r=>{const i=Number(r);return Number.isNaN(i)?r:i});const n=Number(t);return Number.isNaN(n)?[t]:[n]}return[]}function I(e,t){const n=H(e.getAttribute("data-mode"),"single"),r=m(e.getAttribute("data-collapsible"),!1),i=m(e.getAttribute("data-animate"),!0),s=S(e.getAttribute("data-icon"),"chevron"),o=y(e.getAttribute("data-default-open"));return{mode:n,collapsible:r,defaultOpen:o,animate:i,icon:s}}function k(e,t){return e.getAttribute("data-cdw-accordion-item")||e.id||String(t)}function C(e,t){if(typeof t=="number")return e.index===t;if(t.startsWith("id:")){const n=t.slice(3);return e.key===n||e.item.id===n}return e.key===t}function f(e,t,n){if(!n){e.style.maxHeight=t?"none":"0px",e.style.opacity=t?"1":"0",e.style.pointerEvents=t?"auto":"none";return}if(t){e.style.maxHeight=`${e.scrollHeight}px`,e.style.opacity="1",e.style.pointerEvents="auto";const r=i=>{i.propertyName==="max-height"&&(e.style.maxHeight!=="0px"&&(e.style.maxHeight="none"),e.removeEventListener("transitionend",r))};e.addEventListener("transitionend",r);return}(e.style.maxHeight==="none"||e.style.maxHeight==="")&&(e.style.maxHeight=`${e.scrollHeight}px`),e.style.opacity="1",e.style.pointerEvents="none",e.getBoundingClientRect(),e.style.maxHeight="0px",e.style.opacity="0"}function p(e,t){e.trigger.setAttribute("aria-expanded",t?"true":"false"),e.panel.setAttribute("aria-hidden",t?"false":"true")}function A(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:{item:n.item,index:n.index,id:n.key}}))}function h(e,t){t.item.classList.contains("is-open")&&(t.item.classList.remove("is-open"),p(t,!1),f(t.panel,!1,e.options.animate),A(e.container,"cdw:accordion:close",t))}function M(e,t){t.disabled||t.item.classList.contains("is-open")||(e.options.mode==="single"&&e.items.forEach(n=>{n!==t&&h(e,n)}),t.item.classList.add("is-open"),p(t,!0),f(t.panel,!0,e.options.animate),A(e.container,"cdw:accordion:open",t))}function E(e,t){if(t.disabled)return;if(t.item.classList.contains("is-open")){if(e.options.mode==="single"&&!e.options.collapsible)return;h(e,t);return}M(e,t)}function R(e){return Array.from(e.querySelectorAll(d)).map((n,r)=>{const i=n.querySelector(l),s=n.querySelector(N);if(!i||!s)return null;i.id||(i.id=b("cdw-accordion-trigger")),s.id||(s.id=b("cdw-accordion-panel")),i.setAttribute("aria-controls",s.id),i.tagName==="BUTTON"&&!i.getAttribute("type")&&i.setAttribute("type","button"),s.setAttribute("role","region"),s.setAttribute("aria-labelledby",i.id);const o=n.classList.contains("is-disabled")||n.getAttribute("data-disabled")==="true"||i.hasAttribute("disabled")||i.getAttribute("aria-disabled")==="true";return o?(n.classList.add("is-disabled"),i.setAttribute("aria-disabled","true"),i.tagName==="BUTTON"&&i.setAttribute("disabled","true"),i.tagName!=="BUTTON"&&i.setAttribute("tabindex","-1")):(n.classList.remove("is-disabled"),i.removeAttribute("aria-disabled"),i.tagName!=="BUTTON"&&i.setAttribute("tabindex","0")),{item:n,trigger:i,panel:s,index:r,key:k(n,r),disabled:o}}).filter(n=>n!==null)}function D(e){const t=y(e.options.defaultOpen),n=t.length>0;let r=0;e.items.forEach(i=>{const s=n?t.some(a=>C(i,a)):i.item.classList.contains("is-open");e.options.mode==="single"&&r>0&&s&&i.item.classList.remove("is-open");const o=s&&!i.disabled;o?(i.item.classList.add("is-open"),r+=1):i.item.classList.remove("is-open"),p(i,o),f(i.panel,o,e.options.animate)})}function _(e,t){const n=t.target;if(!(n instanceof Element))return;const r=n.closest(l);if(!r||!e.triggerMap.has(r)||r.getAttribute("aria-disabled")==="true"||r.hasAttribute("disabled"))return;const i=e.triggerMap.get(r);i&&E(e,i)}function B(e,t){const n=t.target;if(!(n instanceof Element))return;const r=n.closest(l);if(!r||!e.triggerMap.has(r))return;const i=e.items.filter(a=>!a.disabled).map(a=>a.trigger),s=i.indexOf(r);if(s===-1)return;const o=a=>{const x=i[a];x&&x.focus()};switch(t.key){case"Enter":case" ":case"Spacebar":t.preventDefault(),E(e,e.triggerMap.get(r));break;case"ArrowDown":t.preventDefault(),o((s+1)%i.length);break;case"ArrowUp":t.preventDefault(),o((s-1+i.length)%i.length);break;case"Home":t.preventDefault(),o(0);break;case"End":t.preventDefault(),o(i.length-1);break}}function z(e){e.options.animate&&e.items.forEach(t=>{t.item.classList.contains("is-open")&&(t.panel.style.maxHeight=`${t.panel.scrollHeight}px`)})}function W(e,t){u.has(e)&&U(e);const n=I(e);e.setAttribute("data-icon",n.icon),e.setAttribute("data-animate",n.animate?"true":"false");const r=R(e),i=new Map;r.forEach(o=>i.set(o.trigger,o));const s={container:e,options:n,items:r,triggerMap:i,clickHandler:o=>_(s,o),keyHandler:o=>B(s,o),resizeHandler:()=>z(s)};e.addEventListener("click",s.clickHandler),e.addEventListener("keydown",s.keyHandler),window.addEventListener("resize",s.resizeHandler),D(s),u.set(e,s)}function U(e){const t=u.get(e);t&&(e.removeEventListener("click",t.clickHandler),e.removeEventListener("keydown",t.keyHandler),window.removeEventListener("resize",t.resizeHandler),t.items.forEach(n=>{n.item.classList.remove("is-open"),n.trigger.removeAttribute("aria-expanded"),n.trigger.removeAttribute("aria-controls"),n.panel.removeAttribute("aria-hidden"),n.panel.removeAttribute("aria-labelledby"),n.panel.removeAttribute("role"),n.panel.style.maxHeight="",n.panel.style.opacity="",n.panel.style.pointerEvents=""}),u.delete(e))}function $(e){W(e)}const q="[data-cdw-alert-close]",F="data-autoclose";function K(e){if(!e)return null;const t=Number.parseInt(e,10);return Number.isFinite(t)&&t>0?t:null}function w(e){e.classList.contains("is-hiding")||(e.classList.add("is-hiding"),window.setTimeout(()=>{e.remove()},200))}function P(e){const t=e.querySelector(q);t&&t.addEventListener("click",()=>w(e));const n=K(e.getAttribute(F));n&&window.setTimeout(()=>w(e),n)}function V(e){P(e)}const L="data-cdw-fw-initialized",j={childList:!0,subtree:!0},G=[{name:"accordion",selector:"[data-cdw-accordion]",bind:$},{name:"alert",selector:"[data-cdw-alert]",bind:V}];function Z(e){return e??document}function v(e){const t=e.getAttribute(L);return t?new Set(t.split(" ").filter(Boolean)):new Set}function J(e,t){const n=v(e);n.has(t)||(n.add(t),e.setAttribute(L,Array.from(n).join(" ")))}function Q(e,t){return!v(e).has(t)}function X(e,t){const n=Array.from(e.querySelectorAll(t));return e instanceof HTMLElement&&e.matches(t)&&n.unshift(e),n}function T(e){const t=Z(e);for(const n of G){const r=X(t,n.selector);for(const i of r)if(Q(i,n.name))try{n.bind(i),J(i,n.name)}catch(s){console.warn(`cdw-fw init issue: ${n.name}`,s)}}}function Y(){if(typeof MutationObserver>"u")return;const e=document.body;if(!e)return;new MutationObserver(n=>{for(const r of n)r.addedNodes.forEach(i=>{i instanceof HTMLElement&&T(i)})}).observe(e,j)}function O(){T(document),Y()}typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>O(),{once:!0}):O());const ee="0.1.0";c.CDW_FW_VERSION=ee,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})}));
