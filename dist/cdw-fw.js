(function(a,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(a=typeof globalThis<"u"?globalThis:a||self,u(a.CDWFW={}))})(this,(function(a){"use strict";const u=[];function p(e){const t=u.findIndex(n=>n.name===e.name);if(t>=0){u[t]=e;return}u.push(e)}function _(){return[...u]}const m="[data-cdw-accordion]",z=".cdw-accordion-item",b=".cdw-accordion-trigger",B=".cdw-accordion-panel",c=new WeakMap;let w=0;function L(e){return w+=1,`${e}-${w}`}function v(e){return e instanceof HTMLElement}function x(e,t){return e===null?t:e===""?!0:e==="true"}function W(e,t){return e==="multiple"?"multiple":t}function q(e,t){switch(e){case"plus":case"caret":case"arrow":case"dot":case"chevron":return e;default:return t}}function H(e){if(e==null)return[];if(Array.isArray(e))return e;if(typeof e=="number")return[e];if(typeof e=="string"){const t=e.trim();if(!t)return[];if(t.includes(","))return t.split(",").map(r=>r.trim()).filter(Boolean).map(r=>{const i=Number(r);return Number.isNaN(i)?r:i});const n=Number(t);return Number.isNaN(n)?[t]:[n]}return[]}function $(e,t){const n=W(e.getAttribute("data-mode"),"single"),r=x(e.getAttribute("data-collapsible"),!1),i=x(e.getAttribute("data-animate"),!0),s=q(e.getAttribute("data-icon"),"chevron"),o=H(e.getAttribute("data-default-open"));return{mode:t?.mode??n,collapsible:t?.collapsible??r,defaultOpen:t?.defaultOpen??o,animate:t?.animate??i,icon:t?.icon??s}}function U(e,t){return e.getAttribute("data-cdw-accordion-item")||e.id||String(t)}function l(e,t){if(typeof t=="number")return e.index===t;if(t.startsWith("id:")){const n=t.slice(3);return e.key===n||e.item.id===n}return e.key===t}function y(e,t,n){if(!n){e.style.maxHeight=t?"none":"0px",e.style.opacity=t?"1":"0",e.style.pointerEvents=t?"auto":"none";return}if(t){e.style.maxHeight=`${e.scrollHeight}px`,e.style.opacity="1",e.style.pointerEvents="auto";const r=i=>{i.propertyName==="max-height"&&(e.style.maxHeight!=="0px"&&(e.style.maxHeight="none"),e.removeEventListener("transitionend",r))};e.addEventListener("transitionend",r);return}(e.style.maxHeight==="none"||e.style.maxHeight==="")&&(e.style.maxHeight=`${e.scrollHeight}px`),e.style.opacity="1",e.style.pointerEvents="none",e.getBoundingClientRect(),e.style.maxHeight="0px",e.style.opacity="0"}function h(e,t){e.trigger.setAttribute("aria-expanded",t?"true":"false"),e.panel.setAttribute("aria-hidden",t?"false":"true")}function T(e,t,n){e.dispatchEvent(new CustomEvent(t,{detail:{item:n.item,index:n.index,id:n.key}}))}function A(e,t){t.item.classList.contains("is-open")&&(t.item.classList.remove("is-open"),h(t,!1),y(t.panel,!1,e.options.animate),T(e.container,"cdw:accordion:close",t))}function O(e,t){t.disabled||t.item.classList.contains("is-open")||(e.options.mode==="single"&&e.items.forEach(n=>{n!==t&&A(e,n)}),t.item.classList.add("is-open"),h(t,!0),y(t.panel,!0,e.options.animate),T(e.container,"cdw:accordion:open",t))}function E(e,t){if(t.disabled)return;if(t.item.classList.contains("is-open")){if(e.options.mode==="single"&&!e.options.collapsible)return;A(e,t);return}O(e,t)}function K(e){return Array.from(e.querySelectorAll(z)).map((n,r)=>{const i=n.querySelector(b),s=n.querySelector(B);if(!i||!s)return null;i.id||(i.id=L("cdw-accordion-trigger")),s.id||(s.id=L("cdw-accordion-panel")),i.setAttribute("aria-controls",s.id),i.tagName==="BUTTON"&&!i.getAttribute("type")&&i.setAttribute("type","button"),s.setAttribute("role","region"),s.setAttribute("aria-labelledby",i.id);const o=n.classList.contains("is-disabled")||n.getAttribute("data-disabled")==="true"||i.hasAttribute("disabled")||i.getAttribute("aria-disabled")==="true";return o?(n.classList.add("is-disabled"),i.setAttribute("aria-disabled","true"),i.tagName==="BUTTON"&&i.setAttribute("disabled","true"),i.tagName!=="BUTTON"&&i.setAttribute("tabindex","-1")):(n.classList.remove("is-disabled"),i.removeAttribute("aria-disabled"),i.tagName!=="BUTTON"&&i.setAttribute("tabindex","0")),{item:n,trigger:i,panel:s,index:r,key:U(n,r),disabled:o}}).filter(n=>n!==null)}function j(e){const t=H(e.options.defaultOpen),n=t.length>0;let r=0;e.items.forEach(i=>{const s=n?t.some(d=>l(i,d)):i.item.classList.contains("is-open");e.options.mode==="single"&&r>0&&s&&i.item.classList.remove("is-open");const o=s&&!i.disabled;o?(i.item.classList.add("is-open"),r+=1):i.item.classList.remove("is-open"),h(i,o),y(i.panel,o,e.options.animate)})}function F(e,t){const n=t.target;if(!(n instanceof Element))return;const r=n.closest(b);if(!r||!e.triggerMap.has(r)||r.getAttribute("aria-disabled")==="true"||r.hasAttribute("disabled"))return;const i=e.triggerMap.get(r);i&&E(e,i)}function P(e,t){const n=t.target;if(!(n instanceof Element))return;const r=n.closest(b);if(!r||!e.triggerMap.has(r))return;const i=e.items.filter(d=>!d.disabled).map(d=>d.trigger),s=i.indexOf(r);if(s===-1)return;const o=d=>{const R=i[d];R&&R.focus()};switch(t.key){case"Enter":case" ":case"Spacebar":t.preventDefault(),E(e,e.triggerMap.get(r));break;case"ArrowDown":t.preventDefault(),o((s+1)%i.length);break;case"ArrowUp":t.preventDefault(),o((s-1+i.length)%i.length);break;case"Home":t.preventDefault(),o(0);break;case"End":t.preventDefault(),o(i.length-1);break}}function V(e){e.options.animate&&e.items.forEach(t=>{t.item.classList.contains("is-open")&&(t.panel.style.maxHeight=`${t.panel.scrollHeight}px`)})}function f(e,t){c.has(e)&&N(e);const n=$(e,t);e.setAttribute("data-icon",n.icon),e.setAttribute("data-animate",n.animate?"true":"false");const r=K(e),i=new Map;r.forEach(o=>i.set(o.trigger,o));const s={container:e,options:n,items:r,triggerMap:i,clickHandler:o=>F(s,o),keyHandler:o=>P(s,o),resizeHandler:()=>V(s)};e.addEventListener("click",s.clickHandler),e.addEventListener("keydown",s.keyHandler),window.addEventListener("resize",s.resizeHandler),j(s),c.set(e,s)}function g(e){return typeof e=="string"?document.querySelector(e):e}function G(e){const t=Array.from(e.querySelectorAll(m)).filter(v);return v(e)&&e.matches(m)&&t.unshift(e),t}const Z={init(e,t){G(e??document).forEach(i=>f(i,t))},open(e,t){const n=g(e);if(!n)return;c.has(n)||f(n);const r=c.get(n);if(!r)return;const i=r.items.find(s=>l(s,t));i&&O(r,i)},close(e,t){const n=g(e);if(!n)return;const r=c.get(n);if(!r)return;const i=r.items.find(s=>l(s,t));i&&A(r,i)},toggle(e,t){const n=g(e);if(!n)return;c.has(n)||f(n);const r=c.get(n);if(!r)return;const i=r.items.find(s=>l(s,t));i&&E(r,i)},destroy(e){const t=g(e);t&&N(t)}};function N(e){const t=c.get(e);t&&(e.removeEventListener("click",t.clickHandler),e.removeEventListener("keydown",t.keyHandler),window.removeEventListener("resize",t.resizeHandler),t.items.forEach(n=>{n.item.classList.remove("is-open"),n.trigger.removeAttribute("aria-expanded"),n.trigger.removeAttribute("aria-controls"),n.panel.removeAttribute("aria-hidden"),n.panel.removeAttribute("aria-labelledby"),n.panel.removeAttribute("role"),n.panel.style.maxHeight="",n.panel.style.opacity="",n.panel.style.pointerEvents=""}),c.delete(e))}function J(){p({name:"accordion",selector:m,init:(e,t)=>{f(e)}})}J();const I="0.1.0",S="data-cdw-fw-initialized";function Q(e){return e??document}function k(e){const t=e.getAttribute(S);return t?new Set(t.split(" ").filter(Boolean)):new Set}function X(e,t){const n=k(e);n.has(t)||(n.add(t),e.setAttribute(S,Array.from(n).join(" ")))}function Y(e,t){return!k(e).has(t)}function ee(e,t){const n=Array.from(e.querySelectorAll(t));return e instanceof HTMLElement&&e.matches(t)&&n.unshift(e),n}function C(e){const t=Q(e),n=_();for(const r of n){const i=ee(t,r.selector);for(const s of i)if(Y(s,r.name))try{r.init(s,D),X(s,r.name)}catch(o){console.error(`cdw-fw init error: ${r.name}`,o)}}}function M(e){return C(e),D}const D={version:I,init:M,register:p,scan:C};a.Accordion=Z,a.CDW_FW_VERSION=I,a.init=M,a.register=p,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})}));
